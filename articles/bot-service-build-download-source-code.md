---
title: Скачивание и повторное развертывание исходного кода бота | Документация Майкрософт
description: Узнайте, как скачать и опубликовать службу Azure Bot.
keywords: скачать исходный код, повторно развернуть, развернуть, ZIP-файл, опубликовать
author: ivorb
ms.author: v-ivorb
manager: kamrani
ms.topic: article
ms.service: bot-service
ms.subservice: sdk
ms.date: 09/26/2018
ms.openlocfilehash: 19dd474c16224cc811a214acea6e9cb51da95b3f
ms.sourcegitcommit: cb0b70d7cf1081b08eaf1fddb69f7db3b95b1b09
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/09/2018
ms.locfileid: "51332768"
---
# <a name="download-and-redeploy-bot-code"></a>Скачивание и повторное развертывание кода бота
Служба Azure Bot дает возможность скачать весь исходный проект бота, с которым можно работать локально через любой IDE на ваш выбор. Завершив доработку кода, измененный проект можно снова опубликовать на портале Azure. Здесь мы продемонстрируем, как скачать код с помощью портала Azure и средства CLI `az`. Мы также обсудим повторное развертывание обновленного кода бота с помощью Visual Studio и средства CLI `az`. Вы можете выбрать для себя наиболее удобный метод.

## <a name="prerequisites"></a>Предварительные требования
- Установка [интерфейса командной строки Azure](https://docs.microsoft.com/en-us/cli/azure/?view=azure-cli-latest)
- Установка расширения az botservice с помощью команды `az extension add -n botservice`

### <a name="download-code-using-the-azure-portal"></a>Скачивание кода с помощью портала Azure
Чтобы скачать код с [портала Azure](https://portal.azure.com), выполните следующее.
1. Откройте колонку бота.
1. В разделе **Управление ботами** щелкните **Создать**.
1. В разделе **Скачивание исходного кода** щелкните **Скачать ZIP-файл**.
1. Подождите, пока Azure подготовит URI для скачивания, и щелкните ссылку **Скачать ZIP-файл** в полученном уведомлении.
1. Сохраните ZIP-файл и извлеките его содержимое в локальный каталог.

Если вы используете бот на C#, добавьте в файл `appsettings.json` сведения о файле .bot, как показано ниже:

```
{
  "botFilePath": "yourbasicBot.bot",
  "botFileSecret": "ukxxxxxxxxxxxs="
}
```

Если вы используете бот на node.js, добавьте файл `.env` со следующими элементами:
```
botFilePath=yourbasicBot.bot
botFileSecret=ukxxxxxxxxxxxxs=
```

`botFilePath` ссылается на имя бота. В этой строке достаточно заменить значение yourbasicBot.bot реальным именем вашего бота. Чтобы получить ключ `botFileSecret`, воспользуйтесь статьей [о шифровании файла бота](https://aka.ms/bot-file-encryption), где описано создание ключа для бота.

Затем внесите изменения в исходный проект, отредактировав существующие файлы или добавив новые. Тестирование кода с помощью Emulator. Когда вы будете готовы выполнить повторное развертывание измененного код на портал Azure, следуйте приведенным ниже инструкциям.

### <a name="publish-code-using-visual-studio"></a>Публикация кода с помощью Visual Studio
1. В Visual Studio щелкните проект правой кнопкой мыши и выберите **Опубликовать...**. Откроется окно **Публикация**.

![Публикация в Azure](~/media/azure-bot-build/azure-csharp-publish.png)

2. Выберите профиль для проекта.
3. Скопируйте пароль, указанный в файле _publish.cmd_ для этого проекта.
4. Щелкните **Опубликовать**.
5. В ответ на соответствующий запрос введите пароль, который вы скопировали на шаге 3.   

Когда вы завершите настройку проекта, внесенные изменения будут опубликованы в Azure. 

Далее мы рассмотрим процесс скачивания и повторного развертывания кода с помощью средства CLI `az`.

### <a name="download-code-using-azure-cli"></a>Скачивание кода с помощью Azure CLI

Для начала войдите на портал Azure с помощью средства CLI az.

```azcli
az login
```

Вам будет предложено ввести уникальный временный код. Чтобы выполнить вход, откройте веб-браузер и перейдите на страницу Майкрософт [Имя пользователя устройства](https://microsoft.com/devicelogin) и вставьте на ней код, полученный с помощью CLI.

Чтобы скачать код, используя средство CLI `az`, выполните следующую команду:
```azcli
az bot download --name "my-bot-name" --resource-group "my-resource-group"`
```
После загрузки кода сделайте следующее.
- Если вы используете бот на C#, добавьте в файл appsettings.json сведения о файле .bot, как показано ниже:

```
{
  "botFilePath": "yourbasicBot.bot",
  "botFileSecret": "ukxxxxxxxxxxxs="
}
```

- Если вы используете бот на node.js, добавьте файл .env со следующими элементами:

```
botFilePath=yourbasicBot.bot
botFileSecret=ukxxxxxxxxxxxxs=
```

Затем внесите изменения в исходный проект, отредактировав существующие файлы или добавив новые. Тестирование кода с помощью Emulator. Когда вы будете готовы выполнить повторное развертывание измененного код на портал Azure, следуйте приведенным ниже инструкциям.

### <a name="login-to-azure-cli-by-running-the-following-command"></a>Выполните вход в Azure CLI, выполнив следующую команду.
Этот шаг можно пропустить, если вы уже вошли в систему.

```azcli
az login
```
Вам будет предложено ввести уникальный временный код. Чтобы выполнить вход, откройте веб-браузер и перейдите на страницу Майкрософт [Имя пользователя устройства](https://microsoft.com/devicelogin) и вставьте на ней код, полученный с помощью CLI.

### <a name="publish-code-using-azure-cli"></a>Публикация кода с помощью Azure CLI
Чтобы опубликовать код в Azure с помощью средства CLI `az`, выполните следующую команду:
```azcli
az bot publish --name "my-bot-name" --resource-group "my-resource-group" --code-dir <path to directory> 
```

С помощью параметра `code-dir` можно указать каталог для использования. Если этот параметр не указан, команда `az bot publish` будет использовать для публикации локальный каталог.

## <a name="next-steps"></a>Дополнительная информация
Теперь, когда вы знаете, как передать изменения обратно в Azure, можно настроить для бота непрерывное развертывание.

> [!div class="nextstepaction"]
> [Set up continuous deployment](bot-service-build-continuous-deployment.md) (Настройка непрерывного развертывания)
