---
title: Распознавание речи — Служба Azure Bot
description: Узнайте, как добавить ботам искусственный интеллект с помощью Microsoft Cognitive Services, чтобы сделать их более полезными и привлекательными.
keywords: LUIS, намерение, распознаватель, средство подготовки к отправке, qna, qna maker
author: ivorb
ms.author: kamrani
manager: rstand
ms.topic: article
ms.service: bot-service
ms.date: 09/19/2018
ms.reviewer: ''
monikerRange: azure-bot-service-4.0
ms.openlocfilehash: 00d2d55c5738712ef91cdee1468deedb3e09c66e
ms.sourcegitcommit: f8b5cc509a6351d3aae89bc146eaabead973de97
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/09/2020
ms.locfileid: "75799078"
---
# <a name="language-understanding"></a>Распознавание речи

[!INCLUDE [pre-release-label](../includes/pre-release-label.md)]

Боты могут использовать различные типы общения, от структурированных и направляющих до свободных и открытых. Боту необходимо решить, что делать дальше в потоке общения, исходя из того, что сказал пользователь, и в открытом общении есть более широкий диапазон ответов пользователей.

| Направляющий | Открыть |
|------|------|
| Я бот для путешествий. Выберите один из следующих вариантов: найти авиабилеты, найти отели, найти прокат автомобилей. | Я могу помочь вам забронировать путешествие. Что вы хотите сделать? |
| Требуется что-нибудь еще? Нажмите кнопку "Да" или "Нет". | Требуется что-нибудь еще? |

Взаимодействие между пользователями и ботами часто является свободной формой, и ботам необходимо распознавать речь естественно и в зависимости от контекста. В этой статье объясняется, как API распознавания речи (LUIS) помогает определить, что хотят пользователи, определять понятия и сущности в предложениях и в конечном итоге позволить ботам отвечать соответствующим действием.

## <a name="recognize-intent"></a>Распознавание намерения

Служба [LUIS](https://docs.microsoft.com/azure/cognitive-services/luis/home) помогает определить **намерение** пользователя, что они хотят делать, из того, что они говорят, поэтому бот может ответить соответствующим образом. Служба LUIS особенно полезна, когда то, что пользователи говорят боту, не соответствует предсказуемой структуре или конкретному шаблону. Если у бота есть пользовательский интерфейс общения, в котором пользователь говорит или набирает ответ, могут быть бесконечные вариации *высказываний*, которые являются устными или текстовыми входными данными от пользователя.

Например, рассмотрим множество способов, которыми пользователь бота для путешествий может попросить забронировать авиарейс.

![Различные формулировки высказываний для бронирования авиарейса](media/cognitive-services-add-bot-language/cognitive-services-luis-utterances.png)

Эти высказывания могут иметь разные структуры и содержать различные синонимы слова "полёт", о которых вы даже и не думали. Возможно, тяжело написать логику для бота, которая соответствует всем высказываниям, но все же отличает это намерение от других, содержащих одни и те же слова. Кроме того, боту необходимо извлечь *сущности*, которые являются другими важными словами, такими как расположение и время. Служба LUIS упрощает этот процесс путем контекстной идентификации намерений и сущностей.

При разработке бота для ввода естественного языка, можно определить, какие намерения и сущности бот должен распознавать, и подумать о том, как они будут подключаться к действиям, которые выполняет бот. В приложении [luis.ai](https://www.luis.ai) определяются пользовательские намерения и сущности и указывается их поведение, предоставляя примеры для каждого намерения и маркируя сущности внутри них.

Бот использует намерение, распознаваемое службой LUIS для определения темы общения или начала потока общения. Например, когда пользователь говорит: "I'd like to book a flight", бот обнаруживает намерение BookFlight и вызывает поток общения для начала поиска авиарейсов. Служба LUIS обнаруживает такие объекты, как город назначения и дату отправки, как в исходном высказывании, которое вызывает намерение, так и в потоке общения. Как только бот получит всю необходимую ему информацию, он может выполнить намерение пользователя.

![Активация общения с ботом с помощью намерения BookFlight](media/cognitive-services-add-bot-language/cognitive-services-luis-conversation-high-level.png)

### <a name="recognize-intent-in-common-scenarios"></a>Распознавание намерения в типовых сценариях

Чтобы сохранить время разработки, LUIS предоставляет предварительно подготовленные языковые модели, которые распознают общие высказывания для общих категорий ботов. 

**Предварительно созданные домены** — это предварительно подготовленные, готовые к использованию коллекции намерений и сущностей, которые хорошо сочетаются для общих сценариев, таких как встречи, напоминания, управление, фитнес, развлечения, связь, резервирование и т. д. Предварительно созданный домен **Utilities** помогает боту обрабатывать общие задачи, такие как Cancel, Confirm, Help, Repeat и Stop. Ознакомьтесь с [предварительно созданными доменами](https://docs.microsoft.com/azure/cognitive-services/LUIS/luis-how-to-use-prebuilt-domains), которые предлагаются в LUIS.

**Предварительно созданные сущности** помогают боту распознавать общие типы информации, такие как даты, времена, цифры, температуру, валюту, географию и возраст. Общие сведения о типах, которые может распознать LUIS, см. в статье об [использовании предварительно созданных сущностей](https://docs.microsoft.com/azure/cognitive-services/LUIS/pre-builtentities).

## <a name="how-your-bot-gets-messages-from-luis"></a>Получение ботом сообщения от LUIS

Когда вы настроите и подключите LUIS, бот сможет отправлять сообщения приложениям LUIS, которые возвращают ответ JSON, содержащий намерения и сущности. Затем можно использовать [контекст реплик](~/v4sdk/bot-builder-basics.md#defining-a-turn) в _обработчике реплик_ бота, чтобы направить поток общения в соответствии с намерением в ответе от LUIS. 

![Передача боту намерений и сущностей](./media/cognitive-services-add-bot-language/cognitive-services-luis-message-flow-bot-code.png)

Чтобы начать использовать приложение LUIS с ботом, ознакомьтесь со статьей [об использовании LUIS для распознавания речи](https://docs.microsoft.com/azure/bot-service/bot-builder-howto-v4-luis?view=azure-bot-service-4.0).

## <a name="best-practices-for-language-understanding"></a>Рекомендации для распознавания речи

Изучите рекомендации по разработке языковой модели для бота.

### <a name="consider-the-number-of-intents"></a>Определение количества намерений

Приложения LUIS распознают намерение, классифицируя высказывание в одну из нескольких категорий. Естественным результатом является то, что определение правильной категории из большого количества намерений может уменьшить способность приложения LUIS различать их.

Одним из способов сокращения количества намерений является использование иерархической структуры. Рассмотрим случай личного бота-помощника, который имеет три намерения, связанные с погодой, три намерения, связанные с домашней автоматикой, и три других намерения служебных программ, таких как Help, Cancel и Greeting. Если поместить все намерения в одно и то же приложение LUIS, их будет уже 9, а если добавить функции боту, в конечном итоге намерений может стать больше десятка. Вместо этого можно использовать диспетчер приложения LUIS, чтобы определить, является ли запрос пользователя для погоды, для домашней автоматизации или для служебной программы, затем вызвать приложение LUIS для той категории, которую определил диспетчер. В этом случае каждое из приложений LUIS начинается только с 3-х намерений.

### <a name="use-a-none-intent"></a>Использование намерения None

Часто бывает, что пользователи бота скажут что-то неожиданное или не связанное с текущим потоком общения. Для обработки этих сообщений предусмотрено намерение _None_.

Если не обучать намерение обрабатывать резервный вариант, вариант по умолчанию или "ни один из перечисленных", приложение LUIS может классифицировать сообщения только в намерениях, которые оно определило. Например, предположим, имеется приложение LUIS с двумя намерениями: `HomeAutomation.TurnOn` и `HomeAutomation.TurnOff`. Если это единственные намерения, а входные данные — это что-то несвязанное с ними, например "schedule an appointment on Friday", то приложение LUIS не имеет другого выбора, кроме как классифицировать это сообщение как HomeAutomation.TurnOn или HomeAutomation.TurnOff. Если приложение LUIS имеет намерение `None` с несколькими примерами, можно боту предоставить некоторую резервную логику для обработки неожиданных высказываний.

Намерение `None` отлично подходит для улучшения результатов распознавания. В некоторых сценариях домашней автоматики, такие входные данные, как "schedule an appointment on Friday" могут привести к созданию намерения `HomeAutomation.TurnOn` с низкой степенью уверенности, которое боту следует отклонить. Такие фразы можно добавить в модель с намерением `None`, чтобы они правильно разрешались в `None`.

### <a name="review-the-utterances-that-luis-app-receives"></a>Просмотр высказываний, получаемых приложением LUIS

Приложения LUIS предоставляют функцию для повышения производительности приложения, просматривая сообщения, отправленные пользователям. Пошаговое инструкции см. в статье [Просмотр фрагментов речи конечной точки](https://docs.microsoft.com/azure/cognitive-services/LUIS/label-suggested-utterances).


## <a name="integrate-multiple-luis-apps-and-qna-services-with-the-dispatch-tool"></a>Интеграция нескольких приложений LUIS и служб QnA Maker с помощью средства подготовки к отправке

При создании многоцелевого бота, который понимает несколько тем общения, можно приступить к разработке служб для каждой отдельной функции, а затем объединить их вместе. Эти службы могут включать приложения распознавания речи (LUIS) и службы QnA Maker. Вот несколько примеров сценариев, в которых бот может комбинировать несколько приложений LUIS, несколько служб QnA Maker или их комбинацию.

* Личный бот-помощник позволяет пользователю вызывать различные команды. Каждая категория команд формирует "навык", который можно разработать отдельно, а каждый навык имеет приложение LUIS.
* Бот выполняет поиск по многим базам знаний, чтобы найти ответы на часто задаваемые вопросы (FAQs).
* У бота для бизнеса есть приложения LUIS для создания учетных записей клиентов и размещения заказов, а также служба QnA Maker для часто задаваемых вопросов.  

### <a name="the-dispatch-tool"></a>Средство подготовки к отправке

Средство подготовки к отправке помогает интегрировать несколько приложений LUIS и служб QnA Maker с ботом, создав *приложение для отправки*, которое является новым приложениям LUIS, направляющее сообщения в соответствующие службы LUIS и QnA Maker. Пошаговое инструкции по объединению нескольких приложений LUIS и QnA Maker в одном боте с помощью средства Dispatch см. [в этой статье](./bot-builder-tutorial-dispatch.md).

## <a name="use-luis-to-improve-speech-recognition"></a>Использование LUIS для улучшения распознавания речи

Интеграция со службой LUIS может помочь боту, с которым будут разговаривать пользователи, идентифицировать слова, которые могут быть неправильно поняты при преобразовании речи в текст.  Например, в сценарии шахматной игры пользователь может сказать: "Move knight to A 7". Без контекста для намерения пользователя высказывание может распознаваться как: "Move night 287". Создавая сущности, представляющие шахматные фигуры и координаты, и помещая их в высказывания, предоставляется контекст распознавания речи для их идентификации. Можно [включить распознавание речи](https://docs.microsoft.com/azure/bot-service/bot-service-manage-speech-priming?view=azure-bot-service-4.0) каналами Bot Framework, которые интегрированы в API распознавания речи Bing, такими как веб-чат, Bot Framework Emulator и Кортана.  

## <a name="additional-resources"></a>Дополнительные ресурсы
Дополнительные сведения см. в документации по [Cognitive Services](https://docs.microsoft.com/azure/cognitive-services/).
