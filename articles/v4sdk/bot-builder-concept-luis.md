---
title: API распознавания речи для ботов | Документация Майкрософт
description: Узнайте, как добавить ботам искусственный интеллект с помощью Microsoft Cognitive Services, чтобы сделать их более полезными и привлекательными.
keywords: LUIS, намерение, распознаватель, средство подготовки к отправке, qna, qna maker
author: DeniseMak
ms.author: v-demak
manager: rstand
ms.topic: article
ms.prod: bot-framework
ms.date: 03/22/2018
ms.reviewer: ''
monikerRange: azure-bot-service-4.0
ms.openlocfilehash: ec7385db42264b44303e6abd6a7edde06bfe84e9
ms.sourcegitcommit: dcbc8ad992a3e242a11ebcdf0ee99714d919a877
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/30/2018
ms.locfileid: "39352893"
---
# <a name="language-understanding-for-bots"></a>API распознавания речи для ботов
[!INCLUDE [pre-release-label](../includes/pre-release-label.md)]

Боты могут использовать различные типы общения, от структурированных и направляющих до свободных и открытых. Боту необходимо решить, что делать дальше в последовательности общения, исходя из того, что сказал пользователь, и в открытом общении есть более широкий диапазон ответов пользователей.

| Направляющий | Откройте |
|------|------|
| Я бот для путешествий. Выберите один из следующих вариантов: найти авиабилеты, найти отели, найти прокат автомобилей. | Я могу помочь вам забронировать путешествие. Что вы хотите сделать? |
| Требуется что-нибудь еще? Нажмите кнопку "Да" или "Нет". | Требуется что-нибудь еще? |

Взаимодействие между пользователями и ботами часто является свободной формой, и ботам необходимо распознавать речь естественно и в зависимости от контекста. В этой статье объясняется, как API распознавания речи (LUIS) помогает определить, что хотят пользователи, определять понятия и сущности в предложениях и в конечном итоге позволить ботам отвечать соответствующим действием.

## <a name="recognize-intent"></a>Распознавание намерения

Служба [LUIS](https://www.luis.ai) помогает определить **намерение** пользователя, что они хотят делать, из того, что они говорят, поэтому бот может ответить соответствующим образом. Служба LUIS особенно полезна, когда то, что пользователи говорят боту, не соответствует предсказуемой структуре или конкретному шаблону. Если у бота есть пользовательский интерфейс общения, в котором пользователь говорит или набирает ответ, могут быть бесконечные вариации *высказываний*, которые являются устными или текстовыми входными данными от пользователя.

Например, рассмотрим множество способов, которыми пользователь бота для путешествий может попросить забронировать авиарейс. 



![Различные формулировки высказываний для бронирования авиарейса](media/cognitive-services-add-bot-language/cognitive-services-luis-utterances.png)

Эти высказывания могут иметь разные структуры и содержать различные синонимы слова "полёт", о которых вы даже и не думали. Возможно тяжело написать логику для бота, которая соответствует всем высказываниям, но все же отличает это намерение от других, содержащих одни и те же слова. Кроме того, боту необходимо извлечь *сущности*, которые являются другими важными словами, такими как расположение и время. Служба LUIS упрощает этот процесс путем контекстной идентификации намерений и сущностей.

При разработке бота для ввода естественного языка, можно определить, какие намерения и сущности бот должен распознавать, и подумать о том, как они будут подключаться к действиям, которые выполняет бот. В службе <a href="https://www.luis.ai" target="_blank">LUIS</a> определяются пользовательские намерения и сущности и указывается их поведение, предоставляя примеры для каждого намерения и маркируя сущности внутри них.

Бот использует намерение, распознаваемое службой LUIS для определения темы общения или начала последовательности общения. Например, когда пользователь говорит: "I'd like to book a flight", бот обнаруживает намерение BookFlight и вызывает последовательность общения для начала поиска авиарейсов. Служба LUIS обнаруживает такие объекты, как город назначения и дату отправки, как в исходном высказывании, которое вызывает намерение, так и позже в последовательности общения. Как только бот получит всю необходимую ему информацию, он может выполнить намерение пользователя.


![Активация общения с ботом с помощью намерения BookFlight](media/cognitive-services-add-bot-language/cognitive-services-luis-conversation-high-level.png)


### <a name="recognize-intent-in-common-scenarios"></a>Распознавание намерения в типовых сценариях

Чтобы сохранить время разработки, LUIS предоставляет предварительно подготовленные языковые модели, которые распознают общие высказывания для общих категорий ботов. <!-- Consider if you'll use prebuilt or custom intents and entities: -->

* **Предварительно созданные домены** — это предварительно подготовленные, готовые к использованию коллекции намерений и сущностей, которые хорошо сочетаются для общих сценариев, таких как встречи, напоминания, управление, фитнес, развлечения, связь, резервирование и т. д. Предварительно созданный домен **Utilities** помогает боту обрабатывать общие задачи, такие как Cancel, Confirm, Help, Repeat и Stop. Ознакомьтесь с примером напоминаний для [C#]( https://github.com/Microsoft/botbuilder-dotnet/tree/master/samples-final/8.AspNetCore-LUIS-Bot) или [JavaScript](https://github.com/Microsoft/botbuilder-js/tree/master/samples/luis-bot-es6) в качестве примера использования предварительно созданного домена в боте и взгляните на [предварительно созданные домены](https://docs.microsoft.com/en-us/azure/cognitive-services/LUIS/luis-how-to-use-prebuilt-domains), которые предлагает LUIS.
* **Предварительно созданные сущности** помогают боту распознавать общие типы информации, такие как даты, времена, цифры, температуру, валюту, географию и возраст.
Пример использования LUIS для извлечения дат см. в разделе [Extract intents and entities using LUISGen][luis-v4-typed-entities] (Извлечение намерений и сущностей с помощью LUISGen). Дополнительные сведения о фонах в типах, которые может распознать LUIS, см. в разделе [Предварительно созданные сущности](https://docs.microsoft.com/en-us/azure/cognitive-services/LUIS/pre-builtentities). 



<!-- TODO: Link to Bot Framework design guidance about LUIS apps, when this is ready --> 


## <a name="how-your-bot-gets-messages-from-luis"></a>Получение ботом сообщения от LUIS
Каждый раз, когда бот с интегрированной LUIS получает высказывание, он отправляет его в приложение LUIS, которое возвращает ответ JSON, содержащий намерения и сущности. Пакет SDK для Bot Builder предоставляет функциональность (реализованную как [ПО промежуточного слоя](bot-builder-concept-middleware.md)) для автоматической обработки ответов от LUIS и передачи их боту. Можно использовать функцию _включить контекст_ в _обработчике получения_ бота для направления последовательности общения на основе намерения в ответ LUIS. 

![Передача боту намерений и сущностей](./media/cognitive-services-add-bot-language/cognitive-services-luis-message-flow-bot-code.png)

Дополнительные сведения о начале работы с ботом с интегрированной LUIS см. в разделе:

* [Using LUIS for Language Understanding][luis-v4-how-to] (Использование LUIS для распознавания речи)

## <a name="best-practices-for-language-understanding"></a>Рекомендации для распознавания речи
Изучите рекомендации по разработке языковой модели для бота.

### <a name="consider-the-number-of-intents"></a>Определение количества намерений
Приложения LUIS распознают намерение, классифицируя высказывание в одну из нескольких категорий. Естественным результатом является то, что определение правильной категории из большого количества намерений может уменьшить способность приложения LUIS различать их. 

Одним из способов сокращения количества намерений является использование иерархической структуры. Рассмотрим случай личного бота-помощника, который имеет три намерения, связанные с погодой, три намерения, связанные с домашней автоматикой, и три других намерения служебных программ, таких как Help, Cancel и Greeting. Если поместить все намерения в одно и то же приложение LUIS, их будет уже 9, а если добавить функции боту, в конечном итоге намерений может стать больше десятка. Вместо этого можно использовать диспетчер приложения LUIS, чтобы определить, является ли запрос пользователя для погоды, для домашней автоматизации или для служебной программы, затем вызвать приложение LUIS для той категории, которую определил диспетчер. В этом случае каждое из приложений LUIS начинается только с 3-х намерений. 

### <a name="use-a-none-intent"></a>Использование намерения None 
Часто бывает, что пользователи бота скажут что-то неожиданное или не связанное с текущей последовательностью общения. Для обработки этих сообщений предусмотрено намерение None. Если не обучать намерение обрабатывать резервный вариант, вариант по умолчанию или "ни один из перечисленных", приложение LUIS может классифицировать сообщения только в намерениях, которые оно определило. Например, предположим, имеется приложение LUIS с двумя намерениями: `HomeAutomation.TurnOn` и `HomeAutomation.TurnOff`. Если это единственные намерения, а входные данные — это что-то несвязанное с ними, например "schedule an appointment on Friday", то приложение LUIS не имеет другого выбора, кроме как классифицировать это сообщение как HomeAutomation.TurnOn или HomeAutomation.TurnOff. Если приложение LUIS имеет намерение `None` с несколькими примерами, можно боту предоставить некоторую резервную логику для обработки неожиданных высказываний.  

### <a name="review-the-utterances-that-luis-app-receives"></a>Просмотр высказываний, получаемых приложением LUIS
Приложения LUIS предоставляют функцию для повышения производительности приложения, просматривая сообщения, отправленные пользователям. Пошаговое руководство см. в разделе [Просмотр фрагментов речи конечной точки](https://docs.microsoft.com/en-us/azure/cognitive-services/LUIS/label-suggested-utterances).

## <a name="integrate-multiple-luis-apps-and-qna-services-with-the-dispatch-tool"></a>Интеграция нескольких приложений LUIS и служб QnA Maker с помощью средства подготовки к отправке

<!-- 1. Modular. 2. Better performance for classification --> При создании многоцелевого бота, который понимает несколько тем общения, можно приступить к разработке служб для каждой функции отдельно, а затем объединить их вместе. Эти службы могут включать приложения распознавания речи (LUIS) и службы QnA Maker. Вот несколько примеров сценариев, в которых бот может комбинировать несколько приложений LUIS, несколько служб QnA Maker или их комбинацию.

* Личный бот-помощник позволяет пользователю вызывать различные команды. Каждая категория команд формирует "навык", который можно разработать отдельно, а каждый навык имеет приложение LUIS.
* Бот обыскивает многие базы знаний, чтобы найти ответы на часто задаваемые вопросы (FAQs). 
* У бота для бизнеса есть приложения LUIS для создания учетных записей клиентов и размещения заказов, а также служба QnA Maker для часто задаваемых вопросов.  

### <a name="the-dispatch-tool"></a>Средство подготовки к отправке
Средство подготовки к отправке помогает интегрировать несколько приложений LUIS и служб QnA Maker с ботом, создав *приложение для отправки*, которое является новым приложениям LUIS, направляющее сообщения в соответствующие службы LUIS и QnA Maker. Пошаговое руководство, которое объединяет несколько приложений LUIS и QnA Maker в одном боте, см. в разделе [Integrate multiple LUIS apps and QnA services with the Dispatch tool](./bot-builder-tutorial-dispatch.md) (Интеграция нескольких приложений LUIS и служб QnA Maker с помощью средства подготовки к отправке).

## <a name="use-luis-to-improve-speech-recognition"></a>Использование LUIS для улучшения распознавания речи

Интеграция со службой LUIS может помочь боту, с которым будут разговаривать пользователи, идентифицировать слова, которые могут быть неправильно поняты при преобразовании речи в текст.  Например, в сценарии шахматной игры пользователь может сказать: "Move knight to A 7". Без контекста для намерения пользователя высказывание может распознаваться как: "Move night 287". Создавая сущности, представляющие шахматные фигуры и координаты, и помещая их в высказывания, предоставляется контекст распознавания речи для их идентификации. Можно [Включить распознавание речи][speechrecognitionpriming] каналами Bot Framework, которые интегрированы с API распознавания речи Bing, такими как веб-чат, Bot Framework Emulator и Кортана.  


## <a name="additional-resources"></a>Дополнительные ресурсы

- [Language understanding](~/bot-service-concept-intelligence.md#language-understanding) (Распознавание речи)
- <a href="https://www.luis.ai" target="_blank">LUIS website</a> (Веб-сайт LUIS)

<!-- Links -->
[luis_home]: https://docs.microsoft.com/en-us/azure/cognitive-services/luis/home
[middleware]: bot-builder-concept-middleware.md
<!-- TODO: this link is a placeholder, need to find existing speech priming article -->
[speechrecognitionpriming]: ../bot-service-channel-connect-webchat-speech.md



[luis-v4-typed-entities]: bot-builder-howto-v4-luisgen.md
[luis-v4-how-to]: bot-builder-howto-v4-luis.md
[luis-v4-cs-quickstart]: https://github.com/Microsoft/botbuilder-dotnet/wiki/Using-LUIS-and-QnA-Maker
[luis-v4-js-quickstart]: https://github.com/Microsoft/botbuilder-js/wiki/Using-LUIS-and-QnA-Maker

## <a name="next-steps"></a>Дополнительная информация

Cognitive Services предоставляет способы добавления интеллекта для бота.

> [!div class="nextstepaction"]
> [Add intelligence to bots with Cognitive Services](../bot-service-concept-intelligence.md) (Добавление интеллекта ботам с помощью Cognitive Services)
