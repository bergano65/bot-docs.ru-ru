---
title: Тестирование и отладка ботов с помощью эмулятора Bot Framework | Документы Майкрософт
description: Сведения о проверке, тестировании и отладке ботов с помощью классического приложения "Эмулятор Bot Framework".
keywords: расшифровка, инструмент msbot, языковые службы, распознавание речи
author: DeniseMak
ms.author: v-demak
manager: kamrani
ms.topic: article
ms.service: bot-service
ms.date: 2/26/2019
ms.openlocfilehash: 0e548700e81fff5029031fd1e349cc75d9d0bc7a
ms.sourcegitcommit: dbbfcf45a8d0ba66bd4fb5620d093abfa3b2f725
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/28/2019
ms.locfileid: "67464645"
---
# <a name="debug-with-the-emulator"></a>Отладка ботов с помощью эмулятора

Эмулятор Bot Framework — это классическое приложение, которое позволяет разработчикам локально или удаленно тестировать и отлаживать боты. С помощью эмулятора вы можете общаться с ботом и проверять сообщения, которые он посылает и получает. Эмулятор отображает сообщения так, как они будут выглядеть в интерфейсе веб-чата, и регистрирует запросы и ответы JSON при обмене сообщениями с ботом. Перед развертыванием бота в облаке запустите его локально и протестируйте с помощью эмулятора. Вы можете протестировать бот с помощью эмулятора, даже если вы еще не [создали](./bot-service-quickstart.md) его в службе Azure Bot или не настроили для запуска во всех каналах.

## <a name="prerequisites"></a>Предварительные требования
- Установите [эмулятор](https://aka.ms/Emulator-wiki-getting-started).

## <a name="connect-to-a-bot-running-on-localhost"></a>Подключение к боту, работающему на локальном узле

![Интерфейс эмулятора](media/emulator-v4/emulator-welcome.png)

Чтобы подключиться к локально выполняемому боту, щелкните **Open bot** (Открыть бота) или выберите предварительно настроенный файл конфигурации (.bot). Файл конфигурации для подключения к боту не требуется, но при его наличии эмулятор будет с ним работать. Если бот выполняется с [учетными данными учетной записи Майкрософт (MSA)](#use-bot-credentials), введите эти учетные данные.

![Интерфейс эмулятора](media/emulator-v4/emulator-open-bot.png)

### <a name="use-bot-credentials"></a>Использование учетных данных бота

Открыв бот, задайте **идентификатор приложения Майкрософт** и **пароль приложения Майкрософт**, если бот выполняется с учетными данными. Если вы создали бот с помощью службы Azure Bot, учетные данные доступны в Службе приложений бота в разделе **Параметры -> Конфигурация**. Если вы не знаете значения, можно удалить их из файла конфигурации локально запущенного бота, а затем запустить бот в эмуляторе. Если бот не работает с этими параметрами, эмулятор тоже не нужно запускать с ними. 

## <a name="view-detailed-message-activity-with-the-inspector"></a>Просмотр действий с сообщениями с помощью инспектора

Отправьте боту сообщение и получите от него ответ. Можно щелкнуть сообщение в окне беседы, чтобы просмотреть необработанные действия JSON с помощью функции **Инспектор** в правой части окна. При выборе сообщение станет желтым, и объект действия JSON будет отображаться слева от окна чата. Данные JSON включают метаданные ключа, в том числе channelID, тип действия, идентификатор беседы, текстовое сообщение, URL-адрес конечной точки и т. д. Можно проверить действия, отправленные пользователем, а также действия, с помощью которых бот отвечает. 

![Действия с сообщениями эмулятора](media/emulator-v4/emulator-view-message-activity-03.png)

## <a name="save-and-load-conversations-with-bot-transcripts"></a>Сохранение и загрузка бесед с расшифровками бота

Действия в эмуляторе можно сохранить в качестве расшифровок. В открытом окне интерактивного чата выберите **Save Transcript As** (Сохранить расшифровку как) для файла расшифровки. Нажав кнопку **Начать сначала**, можно в любое время очистить беседу и перезапустить подключение к боту.  

![Эмулятор сохраняет расшифровки](media/emulator-v4/emulator-save-transcript.png)

Чтобы загрузить расшифровки, последовательно выберите **Файл > Open Tranascript File (Открыть файл расшифровки)** , а затем выберите расшифровку. Откроется новое окно расшифровки, и в окне вывода отобразятся действия с сообщениями. 

![Эмулятор загружает расшифровки](media/emulator-v4/emulator-load-transcript.png)

## <a name="add-services"></a>Добавление служб 

Приложение LUIS, базу знаний QnA или модель диспетчеризации можно зарегистрировать для бота напрямую из эмулятора. После загрузки бота нажмите кнопку служб на левом краю окна эмулятора. Вы увидите параметры для добавления LUIS, QnA Maker и средства Dispatch в меню **Службы**. 

Чтобы добавить приложение службы, просто щелкните кнопку **+** и выберите службу, которую хотите добавить. Вам будет предложено войти на портал Azure, чтобы добавить службу в BOT-файл и подключить ее к приложению бота. 

> [!IMPORTANT]
> Добавление служб возможно только в том случае, если вы используете файл конфигурации `.bot`. Службы следует добавлять независимо друг от друга. Дополнительные сведения об этом см. в статье [об управлении ресурсами бота](v4sdk/bot-file-basics.md) или в статьях с руководствами по отдельным службам, которые вы намерены добавить.
>
> Если вы не используете файл `.bot`, на панели слева не будут указаны службы (даже если бот их использует), а будет отображаться сообщение о том, что *службы недоступны*.

![Подключение к LUIS](media/emulator-v4/emulator-connect-luis-btn.png)

Подключив любую из этих служб, можно вернуться в окно чата в реальном времени и убедиться, что службы подключены и работают. 

![QnA подключен](media/emulator-v4/emulator-view-message-activity.png)

## <a name="inspect-services"></a>Проверка служб

С помощью эмулятора версии 4 вы также можете проверить ответы JSON от LUIS и QnA. Для бота с подключенными языковыми службами в окне журнала в нижнем правом углу можно выбрать **трассировку**. Этот новый инструмент также предоставляет компоненты для обновления языковых служб непосредственно из эмулятора. 

![Инспектор LUIS](media/emulator-v4/emulator-luis-inspector.png)

Если подключена служба LUIS, вы заметите, что в ссылке трассировки указана **трассировка Luis**. Выбрав ее, вы увидите необработанный ответ от службы LUIS, включающий намерения, сущности и соответствующие оценки. Также имеется возможность переназначить намерения для фраз пользователей. 

![Инспектор QnA](media/emulator-v4/emulator-qna-inspector.png)

Если подключена служба QnA, журнал отобразит **трассировку QnA**. Выбрав ее, можно выполнить предварительный просмотр пары "вопрос-ответ", связанной с этим действием, наряду с оценкой достоверности. Здесь можно добавить выражения альтернативных вопросов для ответа.

<!--## Configure ngrok

If you are using Windows and you are running the Bot Framework Emulator behind a firewall or other network boundary and want to connect to a bot that is hosted remotely, you must install and configure **ngrok** tunneling software. The Bot Framework Emulator integrates tightly with ngrok tunnelling software (developed by [inconshreveable][inconshreveable]), and can launch it automatically when it is needed.

Open the **Emulator Settings**, enter the path to ngrok, select whether or not to bypass ngrok for local addresses, and click **Save**.

![ngrok path](media/emulator-v4/emulator-ngrok-path.png)
-->

## <a name="login-to-azure"></a>Вход в Azure

Для входа в учетную запись Azure можно использовать Эмулятор. Это особенно полезно для добавления служб, от которых зависит ваш бот, и управления ими. В разделе [выше](#add-services) представлены дополнительные сведения о службах, которыми вы можете управлять с помощью Эмулятора.

### <a name="to-login"></a>Выполнение входа

![Вход в Azure](media/emulator-v4/emulator-azure-login.png)

Чтобы выполнить вход, сделайте следующее:
- Щелкните File (Файл)-> Sign in with Azure (Вход с помощью Azure).
- На экране приветствия нажмите кнопку Sign in with your Azure account (Войти в систему, используя учетную запись Azure). Здесь вы также можете указать, что Эмулятор должен автоматически выполнять вход после перезагрузки приложения в Эмуляторе.

![Вход в Azure](media/emulator-v4/emulator-azure-login-success.png)

## <a name="disabling-data-collection"></a>Отключение сбора данных

Если вы решите, что Эмулятор не должен далее собирать данные об использовании, сбор данных можно отключить следующим образом.

1. Перейдите на страницу параметров Эмулятора, нажав кнопку параметров (с изображением шестеренки) на панели навигации слева.

    ![Отключение сбора данных](media/emulator-v4/emulator-disable-data-1.png)

2. Снимите флажок *Help improve the Emulator by allowing us to collect usage data* (Помогите нам улучшить эмулятор, разрешив собирать данные об использовании) в разделе **Data Collection** (Сбор данных).

    ![Отключение сбора данных](media/emulator-v4/emulator-disable-data-2.png)

3. Нажмите кнопку "Сохранить".

    ![Отключение сбора данных](media/emulator-v4/emulator-disable-data-3.png)
    
Если вы передумаете, его можно снова включить, установив флажок.

## <a name="additional-resources"></a>Дополнительные ресурсы

Эмулятор Bot Framework — это решение с открытым исходным кодом. Вы можете [принять участие][EmulatorGithubContribute] to the development and [submit bugs and suggestions][EmulatorGithubBugs] в разработке, отправляя ошибки и предложения.

Подробные сведения см. в статье об [устранении общих проблем](bot-service-troubleshoot-bot-configuration.md) и других статья об устранении неполадок в этом разделе.

## <a name="next-steps"></a>Дополнительная информация

Сохранение расшифровки беседы в файл позволяет быстро подбирать и воспроизводить определенные наборы взаимодействий для целей отладки.

> [!div class="nextstepaction"]
> [Отладка бота с помощью файлов записей разговоров](~/v4sdk/bot-builder-debug-transcript.md)

<!-- Footnote-style URLs -->

[EmulatorGithubContribute]: https://github.com/Microsoft/BotFramework-Emulator/wiki/How-to-Contribute
[EmulatorGithubBugs]: https://github.com/Microsoft/BotFramework-Emulator/wiki/Submitting-Bugs-%26-Suggestions

[ngrokDownload]: https://ngrok.com/
[inconshreveable]: https://inconshreveable.com/
