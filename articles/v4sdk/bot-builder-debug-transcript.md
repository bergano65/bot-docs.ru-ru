---
title: Отладка бота с помощью файлов записей разговоров | Документация Майкрософт
description: Узнайте, как использовать файл записи разговора для отладки бота.
keywords: debugging, faq, transcript file, emulator
author: DanDev33
ms.author: v-dashel
manager: kamrani
ms.topic: article
ms.service: bot-service
ms.subservices: sdk
ms.date: 10/18/2018
monikerRange: azure-bot-service-4.0
ms.openlocfilehash: a7a8b7088e65d015f22438ee2050f97823b72e49
ms.sourcegitcommit: 49a76dd34d4c93c683cce6c2b8b156ce3f53280e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/26/2018
ms.locfileid: "50134799"
---
# <a name="debug-your-bot-using-transcript-files"></a>Отладка бота с помощью файлов записей разговоров
[!INCLUDE [pre-release-label](../includes/pre-release-label.md)]

Один из залогов успеха в тестировании и отладке бота — возможность записать и просмотреть набор условий, возникающих при запуске бота. В этой статье описывается, как создать и использовать файл записи разговора с ботом, чтобы предоставить детальный набор действий пользователя и ответов бота для тестирования и отладки.

## <a name="the-bot-transcript-file"></a>Файл записи разговора с ботом
Файл записи разговора с ботом — это специализированный JSON-файл, в котором хранятся данные о взаимодействии между пользователем и ботом. В нем сохраняется не только содержимое сообщения, но и сведения о взаимодействии, например идентификаторы пользователя и канала, тип и возможности канала, время взаимодействия и т. д. Затем всю эту информацию можно использовать для поиска и устранения проблем при тестировании или отладке бота. 

## <a name="creatingstoring-a-bot-transcript-file"></a>Создание и сохранение файла записи разговора с ботом
В этой статье показано, как создавать файлы записей разговоров с ботами при помощи средства [Bot Framework Emulator](https://github.com/Microsoft/BotFramework-Emulator) от Майкрософт. Файлы записей разговоров также можно создавать программным способом. Дополнительные сведения об этом методе см. [здесь](./bot-builder-howto-v4-storage.md#blob-transcript-storage). В этой статье мы будем использовать пример кода [EchoBot со счетчиком](https://aka.ms/EchoBot-With-Counter) для Bot Framework, который был изменен, чтобы запрашивать имя и номер телефона пользователя, но для создания файла с записью разговора можно использовать любой код, доступный через средство Bot Framework Emulator от Майкрософт.

Чтобы начать этот процесс, убедитесь, что тестируемый код бота выполняется в вашей среде разработки. Запустите Bot Framework Emulator, нажмите кнопку _Открыть бот_ и подключите эмулятор к файлу _конфигурации бота_, как показано на приведенном ниже рисунке.

![подключение эмулятора к коду](./media/emulator_open_bot_configuration.png)

Подключив эмулятор к выполняющемуся коду, протестируйте код, отправив боту имитированные действия пользователя. В этом примере мы передали имя и номер телефона пользователя. Добавив все действия пользователя, которые требуется сохранить, используйте Bot Framework Emulator, чтобы создать и сохранить файл записи разговора, содержащий эту беседу. 

На вкладке _Live Chat_ (показанной ниже) нажмите кнопку _Save transcript_. 

![нажатие кнопки "Save transcript"](./media/emulator_transcript_save.png)

Выберите расположение и имя для файла записи разговора и нажмите кнопку сохранения.

![сохранение записи разговора ursula](./media/emulator_transcript_saveas_ursula.png)

Теперь все действия пользователя и ответы бота, указанные для тестирования кода в эмуляторе, были сохранены в файле записи разговора, который позже можно будет заново загрузить для отладки взаимодействия между пользователем и ботом.

## <a name="retrieving-a-bot-transcript-file"></a>Получение файла записи разговора с ботом
Чтобы получить файл записи разговора с ботом с помощью Bot Framework Emulator, выберите список _TRANSCRIPTS_ в разделе _RESOURCES_ в левом верхнем углу эмулятора, как показано ниже. Затем выберите нужный файл записи разговора. В этом примере мы получаем файл записи разговора "Ursula_User_transcript". При выборе файла записи разговора вся сохраненная беседа автоматически загружается в новую вкладку _Transcript_.

![получение сохраненной записи разговора](./media/emulator_transcript_retrieve.png)

## <a name="debug-using-transcript-file"></a>Отладка с помощью файла записи разговора
Теперь, когда файл записи разговора загружен, все готово к отладке взаимодействия между пользователем и ботом. Для этого просто щелкните любое событие или действие, записанное в разделе _Журнал_ в правой нижней области эмулятора. В приведенном ниже примере мы выбрали первое действие пользователя — отправку сообщения "Hello". При этом все данные из файла записи разговора, связанные с этим сообщением, отображаются в окне _INSPECTOR_ эмулятора в формате JSON. Просмотрев некоторые из этих значение снизу вверх, мы видим:
* что тип действия — _message_;
* время отправки сообщения;
* что отправленный обычный текст содержит строку "Hello";
* что сообщение было отправлено нашему боту;
* идентификатор пользователя и сведения о нем;
* идентификатор канала, его возможности и сведения о нем.

![отладка с помощью записи разговора](./media/emulator_transcript_debug.png)

Этот подробный уровень информации позволяет поэтапно отслеживать взаимодействие между пользователем и ботом. Это полезно для отладки, если бот либо ответил ненадлежащим образом, либо не ответил вообще. Задав оба этих значения и записав действия, предшествовавшие неудачному взаимодействию, вы можете переходить по коду, найти место, где бот не отвечает должным образом, и устранить эти проблемы.

Использование файлов записей разговоров вместе с Bot Framework Emulator — это лишь один из многих способов тестирования и отладки кода бота и взаимодействия с пользователями. Другие способы тестирования и отладки ботов описываются в перечисленных ниже ресурсах.

## <a name="additional-resources"></a>Дополнительные ресурсы
Дополнительные сведения о тестировании и отладке:
* [Рекомендации по тестированию и отладке ботов](./bot-builder-testing-debugging.md)
* [Отладка ботов с помощью Bot Framework Emulator](../bot-service-debug-emulator.md)
* [Отладка в Visual Studio](https://docs.microsoft.com/en-us/visualstudio/debugger/index)


