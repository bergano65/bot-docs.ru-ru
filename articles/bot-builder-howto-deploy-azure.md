---
title: Развертывание бота на C# с помощью Visual Studio | Документация Майкрософт
description: Развертывание бота в облаке Azure.
keywords: deploy bot, azure deploy, publish bot, az deploy bot, visual studio deploy bot, msbot publish, msbot clone
author: ivorb
ms.author: v-ivorb
manager: kamrani
ms.topic: get-started-article
ms.service: bot-service
ms.subservice: abs
ms.date: 12/08/2018
ms.openlocfilehash: eb559418bc2925ec6fb64902086dede50e485414
ms.sourcegitcommit: 32615b88e4758004c8c99e9d564658a700c7d61f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/04/2019
ms.locfileid: "55712018"
---
# <a name="deploy-your-c-bot-using-visual-studio"></a>Развертывание бота на C# с помощью Visual Studio

[!INCLUDE [pre-release-label](./includes/pre-release-label.md)]

Завершив создание и локальную проверку бота, его можно развернуть в Azure, чтобы сделать доступным из любого расположения. Развертывание бота в Azure подразумевает оплату за используемые службы. Статья об [управлении счетами и расходами](https://docs.microsoft.com/en-us/azure/billing/) поможет вам понять, как расшифровывать счета Azure, отслеживать использование и расходы, а также управлять учетными записями и подписками.

В этой статье мы покажем, как развернуть бот на C# с помощью Visual Studio и портала Azure. Будет полезно изучить эту статью перед выполнением описанных действий, чтобы полностью понимать все процессы при развертывании бота.

## <a name="prerequisites"></a>Предварительные требования
- Установленное приложение [Bot Framework Emulator](https://aka.ms/Emulator-wiki-getting-started).
- Понимание структуры файла с расширением [.bot](v4sdk/bot-file-basics.md).

## <a name="deploy-your-bot-in-app-service"></a>Развертывание бота в службе приложений
Сначала нужно развернуть бот в Службе приложений Azure из Visual Studio. Затем настройте бот, используя функцию регистрации каналов бота в службе Azure Bot.

**Примечание. Если имя проекта Visual Studio содержит пробелы, описанные ниже инструкции по развертыванию выполнить не удастся.**

В окне обозревателя решений щелкните правой кнопкой мыши узел проекта и выберите "Опубликовать".

![Параметры публикации](media/azure-bot-quickstarts/getting-started-publish-setting.png)

2. Убедитесь, что в диалоговом окне "Выберите целевой объект публикации" в левой части выбрано **Служба приложений**, а в правой части — **Создать**.

3. Нажмите кнопку "Опубликовать".

4. Убедитесь, что в верхнем правом углу диалогового окна отображается правильный идентификатор пользователя для подписки Azure.

![Публикация основы](media/azure-bot-quickstarts/getting-started-publish-main.png)

5. Введите сведения об имени приложения, подписке, группе ресурсов и плане размещения.

6. Когда все будет готово, нажмите кнопку "Создать". Процесс создания может занять несколько минут.

7. После завершения откроется веб-браузер, отображающий общедоступный URL-адрес бота.

8. Скопируйте этот URL-адрес (он будет выглядеть примерно так: https://<yourbotname>.azurewebsites.net/).

> [!NOTE] 
> При регистрации бота необходимо использовать HTTPS-версию URL-адреса. Azure предоставляет поддержку протокола SSL с помощью Службы приложений Azure.

## <a name="create-your-bot-channels-registration"></a>Создание регистрации канала бота
После развертывания бота в Azure необходимо зарегистрировать его с помощью службы Azure Bot.

1. Перейдите на портал Azure по ссылке https://portal.azure.com.

2. Войдите, используя тот же идентификатор, который использовался ранее в Visual Studio для публикации бота.

3. Щелкните "Создать ресурс".

4. В поле поиска по Marketplace введите "Регистрация канала бота" и нажмите клавишу ВВОД.

5. В возвращенном списке выберите "Регистрация канала бота".

![Опубликовать](media/azure-bot-quickstarts/getting-started-bot-registration.png)

6. В раскрывшейся колонке щелкните "Создать".

7. Задайте имя бота.

8. Выберите ту же подписку, в которой был развернут код бота.

9. Выберите существующую группу ресурсов, которая задаст расположение.

10. Для разработки и тестирования можно выбрать ценовую категорию F0.

11. Введите URL-адрес бота. Убедитесь, что адрес начинается с префикса HTTPS, и добавьте /api/messages. Например, https://yourbotname.azurewebsites.net/api/messages.

12. Пока можно отключить Application Insights.

13. Выберите идентификатор приложения Майкрософт и пароль.

14. В новой колонке щелкните "Создать".

15. В новой колонке, которая раскроется справа, щелкните "Создать идентификатор приложения в портале регистрации приложений". Откроется новая вкладка браузера.

![MSA бота](media/azure-bot-quickstarts/getting-started-msa.png)

16. В новой вкладке скопируйте идентификатор приложения и сохраните его. 

17. Нажмите кнопку "Создать пароль приложения, чтобы продолжить".

18. Откроется диалоговое окно браузера, в котором будет предоставлен пароль приложения. Это единственный раз, когда вы его получите. Скопируйте и сохраните этот пароль.

19. После сохранения пароля щелкните "OK".

20. Просто закройте эту вкладку браузера и вернитесь на вкладку портала Azure.

21. Вставьте идентификатор приложения и пароль в соответствующие поля и щелкните "OK".

22. Теперь щелкните "Создать", чтобы настроить регистрацию канала. Это может занять от нескольких секунд до нескольких минут.

## <a name="update-your-bots-application-settings"></a>Обновление параметров приложения бота
Чтобы бот выполнил проверку подлинности с помощью службы Azure Bot, необходимо добавить два параметра для приложения бота в Службе приложений Azure. 

1. Щелкните "Службы приложений". Введите имя бота в текстовое поле подписок. Затем щелкните имя бота в списке.

![службы приложений](media/azure-bot-quickstarts/getting-started-app-service.png)

2. В списке параметров слева в параметрах бота найдите и щелкните "Параметры приложения" в разделе "Параметры".

![Идентификатор бота](media/azure-bot-quickstarts/getting-started-app-settings-1.png)

3. Найдите раздел параметров приложения.

![MSA бота](media/azure-bot-quickstarts/getting-started-app-settings-2.png)

4. Выберите "Добавить новый параметр".

5. В поле имени введите **MicrosoftAppId**, а в поле значения — идентификатор приложения.

6. Выберите "Добавить новый параметр".

7. В поле имени введите **MicrosoftAppPassword**, а в поле значения — пароль.

8. Нажмите кнопку "Сохранить" вверху.

## <a name="test-your-bot-in-production"></a>Тестирование бота в рабочей среде
На этом этапе можно протестировать бот из Azure с помощью встроенного клиента "Веб-чат".

1. Вернитесь в группу ресурсов на портале Azure.

2. Откройте бот.

3. В разделе **управления ботом** выберите **Test in Web Chat** (Тестировать в веб-чате).

![Тестирование в веб-чате](media/azure-bot-quickstarts/getting-started-test-webchat.png)

4. Введите сообщение, например, `Hi`, и нажмите клавишу ВВОД. Бот передаст обратно `Turn 1: You sent Hi`.

---

## <a name="additional-resources"></a>Дополнительные ресурсы

При развертывании бота, как правило, на портале Azure создаются следующие ресурсы:

| Ресурсы      | ОПИСАНИЕ |
|----------------|-------------|
| Бот веб-приложения | Бот в службе Azure Bot, который развернут в Службе приложений Azure.|
| [Служба приложений](https://docs.microsoft.com/en-us/azure/app-service/)| Позволяет создавать и размещать веб-приложения.|
| [План обслуживания приложения](https://docs.microsoft.com/en-us/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview)| Определяет набор вычислительных ресурсов, на которых выполняется веб-приложение.|
| [Application Insights](https://docs.microsoft.com/en-us/azure/application-insights/app-insights-overview)| Предоставляет средства для сбора и анализа данных телеметрии.|
| [Учетная запись хранения](https://docs.microsoft.com/en-us/azure/storage/common/storage-introduction)| Предоставляет облачную службу с высоким уровнем доступности, безопасности, надежности, масштабируемости и избыточности.|

Если вы еще не знакомы с концепцией группы ресурсов в Azure, изучите раздел со списком [терминов](https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-overview#terminology).

## <a name="next-steps"></a>Дополнительная информация
> [!div class="nextstepaction"]
> [Настройка непрерывного развертывания](bot-service-build-continuous-deployment.md)
