---
title: Мультимедийные вызовы в реальном времени для Skype | Документация Майкрософт
description: Обзор основных понятий, относящихся к созданию бота, который может осуществлять через Skype аудио- и видеовызовы в реальном времени, на основе пакете SDK Bot Framework для .NET.
author: ssulzer
ms.author: ssulzer
manager: kamrani
ms.topic: article
ms.service: bot-service
ms.subservice: sdk
ms.date: 12/13/2017
monikerRange: azure-bot-service-3.0
ms.openlocfilehash: 893458a484c0e26545c23016ccbf3049adc61960
ms.sourcegitcommit: b15cf37afc4f57d13ca6636d4227433809562f8b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/11/2019
ms.locfileid: "54225259"
---
# <a name="real-time-media-calling-with-skype"></a>Основные понятия о мультимедийных вызовах в реальном времени для Skype

[!INCLUDE [pre-release-label](../includes/pre-release-label-v3.md)]

Платформа мультимедиа в реальном времени для ботов добавляет новое измерение того, как боты могут взаимодействовать с пользователями, включив режим передачи голоса, видео и демонстрации экрана в реальном времени. Она предоставляет возможность создания привлекательных и интерактивно-развлекательных, образовательных и вспомогательных ботов. Пользователи взаимодействуют с ботами для мультимедийных вызовов в режиме реального времени, используя Skype.

Это представляет собой дополнительную функцию, которая позволяет ботам отправлять и получать аудио- и видеосодержимое *по кадрам*. Бот получает доступ к режимам передачи голоса, видео и демонстрации экрана в режиме реального времени. Например, пока пользователь говорит, бот будет получать 50 звуковых кадров в секунду, причем каждый кадр содержит 20 миллисекунд (мс) аудио. Бот может выполнять распознавание речи в режиме реального времени по мере приема аудиокадров, а не ждать записи после того, как пользователь перестанет говорить. Бот также может отправлять пользователям видео с высоким разрешением со скоростью 30 кадров в секунду вместе с аудио.

Платформа мультимедиа в реальном времени для ботов работает с облаком вызовов Skype, чтобы позаботиться о настройке вызова и сеанса мультимедиа, позволяя боту участвовать в голосовой и, при необходимости, видеосвязи с абонентом Skype. Платформа предоставляет простой API на базе сокета для отправки и приема мультимедиа, а также для кодирования и декодирования в режиме реального времени с помощью кодеков, таких как SILK для аудио и H.264 для видео. В режиме реального времени бот также может участвовать в групповых видеозвонках Skype с несколькими участниками.

В этой статье представлены основные понятия, связанные с созданием бота, который может выполнять аудио- и видеозвонки в режиме реального времени со Skype, а также предоставлены ссылки на соответствующие ресурсы разработчиков.

## <a name="media-session"></a>Сеанс мультимедиа
Когда бот в режиме реального времени отвечает на входящий вызов Skype, он решает, поддерживать ли режим аудио и видео, или просто аудио. Для каждого поддерживаемого режима бот может отправлять и получать мультимедиа, только получать или только отправлять. Например, бот можете отправлять и получать аудио, но только отправлять видео (так как он не хочет получать видео звонящего по Skype). Набор режимов аудио и видео, установленных между абонентом Skype и ботом, называется **сеансом мультимедиа**.

Поддерживаются два режима видео: "основное видео" и "демонстрация экрана". Основное видео передает видео, которое бот генерирует или воспроизводит вызывающему, и передает видео вызывающего абонента (как правило, с веб-камеры пользователя) боту. Режим демонстрации экрана позволяет вызывающему продемонстрировать свой экран (как видеозапись) боту. Бот не может отправлять видео демонстрации экрана пользователю.

Когда вы подключаетесь к спаренному **групповому видеозвонку** Skype, бот мультимедийных вызовов в режиме реального времени может поддерживать одновременный прием нескольких основных видеопотоков. Это позволяет боту "видеть" нескольких участников в групповом видеозвонке.

## <a name="frames-and-frame-rate"></a>Кадры и их частота
Бот мультимедийных вызовов в режиме реального времени взаимодействует напрямую с режимами аудио- и видеозвонка Skype. Это означает, что бот отправляет или получает мультимедиа как последовательность **кадров**, где каждый кадр представляет собой единицу содержимого. Одна секунда аудио может быть передана как последовательность из 50 кадров, причем каждый кадр содержит 20 миллисекунд (мс) (1/50-ю секунды) содержимого. Видеоролик на одну секунду может быть нарезан как последовательность из 30 изображений, каждое из которых просматривается всего лишь 33 мс (1/30-ю секунды) до отображения следующего кадра. Количество кадров, передаваемых или отображаемых в секунду, называется **частотой кадров**. "30 кадров/с" означает отображение 30 кадров в секунду.

## <a name="audio-format"></a>Формат аудио
Каждая секунда аудио представлена в виде 16 000 **примеров**, причем каждый пример хранит 16 бит данных. Звуковой кадр на 20 мс содержит 320 примеров (640 байт данных).

## <a name="video-format"></a>Формат видео
Существует несколько поддерживаемых форматов для видео. Двумя ключевыми свойствами видео являются **размер кадра** и **формат цвета**. Поддерживаемые размеры кадров: 640 x 360 ("360 пикселей"), 1280 x 720 ("720 пикселей") и 1920 x 1080 ("1080 пикселей"). Поддерживаемые форматы цвета: NV12 (12 бит на пиксель) и RGB24 (24 бита на пиксель).

Кадр видео "720 пикселей" содержит 921 600 пикселей (1280 раз по 720). В формате цвета RGB24 каждый пиксель представлен как 3 байта (24 бита). Он состоит из одного байта каждого из цветовых компонентов: синего, зеленого и красного. Таким образом, для одного кадра видео формата RGB24 с разрешением 720 пикселей требуется 2 764 800 байт данных (921 600 пикселей по 3 байта/пиксель). При частоте 30 кадров в секунду отправка кадров видео формата RGB24 с разрешением 720 пикселей означает обработку содержимого со скоростью приблизительно 80 МБ/с (которое значительно сжимается перед сетевой передачей видеокодеком H.264).

## <a name="active-and-dominant-speakers"></a>Активные и доминирующие участники
При подключении к групповому видеовызову Skype, состоящему из нескольких участников, бот может определить, какие участники в настоящее время говорят. **Активные участники** определяются, когда они прослушиваются в каждом принятом звуковом кадре. **Доминирующие участники** определяют, какие участники в данный момент наиболее активны (или "доминируют") в групповом разговоре, даже если их голос присутствует не в каждом звуковом кадре. Набор доминирующих участников может изменяться по мере того, чья очередь говорить.

## <a name="video-subscription"></a>Подписка на видео
При вызове с одним абонентом Skype бот автоматически получит видео вызывающего абонента (если бот включен для основного видео). В многопользовательском групповом видеозвонке Skype бот должен указывать платформу мультимедиа в реальном времени, которую участники хотят видеть. Подписка на видео — это запрос бота на получение видео участника. Когда участники группового видеозвонка проводят свой разговор, бот может изменять свои желаемые подписки на видео на основе обновлений основного набора доминирующих участников.

## <a name="developer-resources"></a>Ресурсы для разработчиков 

### <a name="sdks"></a>Пакеты SDK

Чтобы создать бот мультимедиа в реальном времени, вы должны установить эти пакеты NuGet в свой проект Visual Studio.

- [Пакет SDK Bot Framework для .NET](bot-builder-dotnet-overview.md)
- [Мультимедийные вызовы Bot Builder в реальном времени для .NET](https://www.nuget.org/packages?q=Bot.Builder.RealTimeMediaCalling)
- [Библиотека Microsoft.Skype.Bots.Media .NET](https://www.nuget.org/packages?q=Microsoft.Skype.Bots.Media)

### <a name="code-samples"></a>Примеры кода

Репозиторий [BotBuilder-RealTimeMediaCalling](https://github.com/Microsoft/BotBuilder-RealTimeMediaCalling) на GitHub содержит образцы, которые показывают, как создать бот для мультимедийных вызовов в режиме реального времени для Skype.
