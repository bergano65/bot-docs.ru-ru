---
title: Подключение бота к LINE — Служба Azure Bot
description: Сведения о настройке подключения бота к LINE.
keywords: connect a bot, bot channel, LINE bot, credentials, configure, phone
author: ivorb
ms.author: kamrani
manager: kamrani
ms.topic: article
ms.service: bot-service
ms.date: 1/7/2019
ms.openlocfilehash: 7898546aeb517fcf1ea4af50e35851a3f09ba633
ms.sourcegitcommit: e5bf9a7fa7d82802e40df94267bffbac7db48af7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/18/2020
ms.locfileid: "77441558"
---
# <a name="connect-a-bot-to-line"></a>Подключение бота к LINE

Вы можете настроить бот для общения с людьми, использующими приложение LINE.

## <a name="log-into-the-line-console"></a>Вход в консоль LINE

Войдите в [консоль разработчика LINE](https://developers.line.biz/console/register/messaging-api/provider/) с учетной записью LINE, используя действие *Log in with Line* (Вход в LINE). 

> [!NOTE]
> Если у вас нет приложения LINE, [скачайте его](https://line.me/) и перейдите к параметрам, чтобы зарегистрировать адрес электронной почты.

### <a name="register-as-a-developer"></a>Регистрация в качестве разработчика

Если вы впервые имеете дело с консолью разработчика LINE, введите здесь имя и адрес электронной почты, чтобы создать учетную запись разработчика.

![Снимок экрана регистрации разработчика LINE](./media/channels/LINE-screenshot-1.png)

## <a name="create-a-new-provider"></a>Создание поставщика

Для начала создайте поставщик для бота, если у вас он еще не настроен. Поставщиком называется физическое или юридическое лицо, которое предоставляет некоторое приложение.

![Снимок экрана: создание поставщика LINE](./media/channels/LINE-screenshot-2.png)

## <a name="create-a-messaging-api-channel"></a>Создание канала API обмена сообщениями

Теперь создайте канал API обмена сообщениями 

![Снимок экрана: тип канала LINE](./media/channels/LINE-channel-type-selection.png)

Создайте канал API обмена сообщениями, щелкнув зеленый квадратик.

![Снимок экрана: создание канала LINE](./media/channels/LINE-create-channel.png)

Имя канала не может содержать строку LINE и некоторые похожие буквосочетания. Заполните обязательные поля и подтвердите параметры канала.

![Снимок экрана: параметры канала LINE](./media/channels/LINE-screenshot-4.png)

## <a name="get-necessary-values-from-your-channel-settings"></a>Получение необходимых значений из настроек канала

Когда вы подтвердите настройки канала, откроется страница со следующим содержимым.

![Снимок экрана: страница канала LINE](./media/channels/LINE-screenshot-5.png)

Щелкните здесь канал, который вы создали для доступа к параметрам канала, и прокрутите экран вниз до раздела **Basic information (Базовая информация) > Channel secret (Секрет канала)** . Сохраните эти сведения, они вам скоро пригодятся. Убедитесь, что в списке доступных функций присутствует `PUSH_MESSAGE`.

![Снимок экрана: секрет канала LINE](./media/channels/LINE-screenshot-6.png)

Теперь прокрутите еще дальше до пункта **Messaging settings** (Параметры обмена сообщениями). Здесь вы увидите поле **Channel access token** (Маркер доступа к каналу) с кнопкой *issue* (Выдать). Нажмите эту кнопку, чтобы получить маркер доступа, и также сохраните его.

![Снимок экрана: маркер канала LINE](./media/channels/LINE-screenshot-8.png)

## <a name="connect-your-line-channel-to-your-azure-bot"></a>Подключение канала LINE к боту Azure

Войдите на [портал Azure](https://portal.azure.com/), найдите нужный бот и щелкните для него **Каналы**. 

![Снимок экрана: параметры Azure для LINE](./media/channels/LINE-channel-setting-2.png)

Теперь выберите канал LINE и вставьте сохраненные ранее значения секрета канала и маркера доступа в соответствующие поля. Не забудьте сохранить изменения.

Скопируйте URL-адрес пользовательского веб-перехватчика, который вам предоставит Azure.

![Снимок экрана: параметры Azure для LINE](./media/channels/LINE-channel-setting-1.png)

## <a name="configure-line-webhook-settings"></a>Настройка параметров веб-перехватчика LINE

Теперь вернитесь к консоли разработчика LINE и вставьте URL-адрес веб-перехватчика Azure в поле **Message settings (Параметры сообщений) > Webhook URL (URL-адрес веб-перехватчика)** , а затем щелкните **Verify** (Проверить) для проверки подключения. Если вы только что создали канал в Azure, он может заработать только через несколько минут.

Теперь включите **Message settings (Параметры сообщений) > Use webhooks (Использовать веб-перехватчики)** .

> [!IMPORTANT]
> В консоли разработчика LINE следует сначала задать URL-адрес веб-перехватчика, и только затем выбрать **Use webhooks = Enabled** (Использовать веб-перехватчики = Включено). Если вы включите веб-перехватчики при пустом значении URL-адреса, состояние этого параметра не изменится, даже если в пользовательском интерфейсе будет указано иное.

Когда вы добавите URL-адрес веб-перехватчика и включите веб-перехватчики, обязательно перезагрузите страницу и убедитесь, что все изменения внесены правильно.

![Снимок экрана: веб-перехватчики LINE](./media/channels/LINE-screenshot-9.png)

## <a name="test-your-bot"></a>Тестирование бота

После успешного завершения этих шагов бот сможет взаимодействовать с пользователями в приложении LINE, и теперь его можно протестировать.

### <a name="add-your-bot-to-your-line-mobile-app"></a>Добавление бота в мобильное приложение LINE

В консоли разработчика LINE перейдите на страницу параметров, где вы найдете QR-кода вашего бота. 

В мобильном приложении LINE перейдите на самую правую вкладку навигации, где изображены три точки [ **...** ] и щелкните значок QR-кода. 

![Снимок экрана: мобильное приложение LINE](./media/channels/LINE-screenshot-12.jpg)

Наведите сканер QR-кодов на QR-код, представленный в консоли разработчика. Теперь вы сможете взаимодействовать с ботом через мобильное приложение LINE, чтобы проверить работу бота.

### <a name="automatic-messages"></a>Автоматические сообщения

Начав тестирование бота, вы можете заметить неожиданные сообщения от бота, которые вы не указывали в действии `conversationUpdate`.  Диалог может выглядеть примерно так:

![Снимок экрана: диалог в LINE](./media/channels/LINE-screenshot-conversation.jpg)

Чтобы избежать отправки таких сообщений, следует отключить автоматическое ответные сообщения.

![Снимок экрана: автоматический ответ LINE](./media/channels/LINE-screenshot-10.png)

При необходимости вы можете сохранить эти сообщения. Для этого можно щелкнуть Set message (Задать сообщение) и изменить сообщение.

![Снимок экрана: настройка автоматического ответа LINE](./media/channels/LINE-screenshot-11.png)

## <a name="troubleshooting"></a>Устранение неполадок

* Если бот совсем не отвечает на сообщения, перейдите к нему на портале Azure и выберите действие "Тестирование в веб-чате".  
    * Если здесь бот работает нормально, но по-прежнему не отвечает в LINE, перезагрузите страницу консоли разработчика LINE и повторно выполните приведенные выше инструкции по настройке веб-перехватчика. Перед включением веб-перехватчиков необходимо настроить **URL-адрес веб-перехватчика**.
    * Если бот не работает даже в веб-чате, выполните отладку для устранения этой проблемы, а затем вернитесь и завершите настройку канала LINE.

